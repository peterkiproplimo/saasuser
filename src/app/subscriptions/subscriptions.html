<!-- Full-screen wrapper -->
<div class="w-full h-screen bg-white dark:bg-gray-900 text-gray-800 dark:text-white flex flex-col">

  <!-- Header bar with button -->
  <div class="px-4 py-4 sm:px-6 lg:px-8 flex justify-between items-center">

    <a routerLink="/customer/subscribe">
      <button
        pButton
        type="button"
        label="New Subscription"
        icon="pi pi-plus"
        class="p-button-primary p-button-sm"

      ></button>
    </a>


  </div>

  <!-- Main scroll area -->
  <div class="flex-1 overflow-y-auto px-4 py-4 sm:px-6 lg:px-8">
    <p-table
      [value]="list().data!"
      [paginator]="true"
      [rows]="5"
      [rowsPerPageOptions]="[5, 10, 20]"
      [tableStyle]="{ 'min-width': '100%' }"
      responsiveLayout="scroll"
    >
      <ng-template #header>
        <tr>
          <th>Subscription #</th>
          <th>Party</th>
          <th>Plan / Qty</th>
          <th>Cost</th>
          <th>Currency</th>
          <th>Invoice Period</th>
          <th>Latest Invoice</th>
          <th>Status</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-sub>
        <tr>
          <td>{{ sub.name }}</td>
          <td>{{ sub.party }}</td>
          <td>
            {{ sub.plans[0]?.plan }}
            <div class="text-xs text-gray-500 dark:text-gray-400">x{{ sub.plans[0]?.qty }}</div>
          </td>
          <td>{{ sub.plans[0]?.cost | number }}</td>
          <td>{{ sub.plans[0]?.currency }}</td>
          <td>{{ sub.current_invoice_start }} → {{ sub.current_invoice_end }}</td>
          <td>
            <div>{{ sub.latest_invoice?.name }}</div>
            <div class="text-xs text-gray-500 dark:text-gray-400">
              {{ sub.latest_invoice?.status }},
              {{ sub.latest_invoice?.prorate_factor }} Prorate
            </div>
          </td>
          <td>
            <p-badge
              [value]="sub.status"
              [severity]="statusSeverity(sub.status)"
              class="capitalize"
            ></p-badge>
          </td>
        </tr>
      </ng-template>
    </p-table>

    @if (is_loading()) {
      <div class="px-4 py-2 text-center text-sm">
        Loading subscriptions...
      </div>

    }

    <div *ngIf="loading || error" class="px-4 py-2 text-center text-sm">
      <span *ngIf="loading">Loading…</span>
      <span *ngIf="error" class="text-red-600">{{ error }}</span>
    </div>

  </div>

<p-dialog
  header="New Subscription"
  [(visible)]="showDialog"
  [modal]="true"
  [style]="{ width: '30rem' }"
  [contentStyle]="{ padding: '1.5rem 2rem' }"
>
  <!-- Form Body -->
  <div class="p-fluid space-y-4">
    <div class="field">
      <label for="plan" class="block text-sm font-medium text-gray-700">Plan</label>
      <input id="plan" pInputText [(ngModel)]="form.plan" />
    </div>

    <div class="field">
      <label for="qty" class="block text-sm font-medium text-gray-700">Quantity</label>
      <input id="qty" type="number" pInputText [(ngModel)]="form.qty" />
    </div>
  </div>
<!-- Footer -->
<ng-template pTemplate="footer">
  <div class="flex justify-center gap-4 py-2">
    <button
      pButton
      label="Cancel"
      class="p-button-text"
      (click)="showDialog = false"
    ></button>
    <button
      pButton
      label="Create"
      class="p-button-primary"
      (click)="createSubscription()"
    ></button>
  </div>
</ng-template>

</p-dialog>



</div>


<div>


</div>
